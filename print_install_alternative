$ip = "0.0.0.0"
$portName = "TCPPort:$ip"

$portExists = Get-Printerport -Name $portname -ErrorAction SilentlyContinue

if (-not $portExists) {
  Add-PrinterPort -name $portName -PrinterHostAddress $ip
}

Add-printerport -Name $portName -PrinterHostAddress $ip
Add-PrinterDriver -Name "PCL6 Driver for Universal Print"
